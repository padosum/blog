---
title   : 블록 레벨 스코프
date    : 2021-05-15 17:05:36 +0900
updated : 2021-05-15 17:05:43 +0900
aliases : 
tags: ["JavaScript"]
---
## var 키워드로 선언한 변수의 문제 
- **변수의 중복 선언이 허용**됨 
- **함수 외부에서 `var` 키워드로 선언한 변수는 코드 블록 내에서 선언해도 모두 전역 변수가 된다**. 함수의 코드 블록만을 지역 스코프로 인정하기 때문이다.(함수 레벨 스코프)
- 변수 선언문 이전에 변수를 참조하는 것은 호이스팅으로 에러는 발생하지 않지만 가독성을 떨어뜨리고 오류를 발생시킬 수 있다. 


## let 키워드 
- ES6에서 `let` 키워드로 변수를 선언하는 것이 도입되었다.  
- 변수 중복 선언이 불가능하다. 의도치 않게 재할당되는 것을 방지 
- `let` 키워드를 사용하면 블록 레벨 유효범위를 사용할 수 있다. 
```javascript
let lscope = 0;
{
    let lscope = 1;
    console.log(lscope); // 1
}
console.log(lscope); // 0
```

### 호이스팅
- `var` 키워드로 선언한 변수와 달리 `let` 키워드로 선언한 변수는 **변수 호이스팅이 발생하지 않는 것처럼 동작**한다. 
```javascript
console.log(foo); // ReferenceError: foo is not defined
let foo;
```
- `var` 키워드로 선언한 변수는 런타임 이전에 [[JavaScript-Engine|자바스크립트 엔진]]에 의해 암묵적으로 "선언 단계"와 "초기화 단계"가 한꺼번에 진행된다. 
- 하지만 **`let` 키워드로 선언한 변수는 "선언 단계"와 "초기화 단계"가 분리되어 진행된다.** 자바스크립트 엔진에 의해 암묵적으로 선언 단계가 먼저 실행되지만 초기화는 변수 선언문에 도달했을 때 실행되는 것.
  - 스코프 시작 지점부터 초기화 시작 지점까지 변수를 참조할 수 없는 구간을 **일시적 사각지대(Temporal Dead Zone; TDZ)**라고 부른다.
- TDZ를 나타내는 것이면 변수 호이스팅이 발생하지 않는 것인가? 
    ```javascript
    let foo = 1; 
    {
        console.log(foo); // ReferenceError
        let foo = 2;
    }
    ```
    - 호이스팅이 발생하지 않는다면 전역 변수 `foo`의 값을 출력해야 한다. 호이스팅은 발생하기에 참조 에러가 발생하는 것이다. 
- 자바스크립트는 모든 선언(`var`, `let`, `const`, `function`)을 호이스팅한다.
- `let`으로 선언한 전역 변수는 전역 객체의 프로퍼티가 아니다. 
  - `window.foo`로 접근할 수 없다. 
  ```javascript
  let x = 1;

  console.log(window.x); // undefined
  console.log(x); // 1
  ```

## const 키워드 
- 상수를 선언하기 위해 사용한다. 

### 선언과 초기화 
- `const`로 선언한 변수는 반드시 선언과 동시에 초기화해야 한다. 추후에 변경할 수 없기에... 
- `let`처럼 블록 레벨 스코프를 가지고 변수 호이스팅이 발생하지 않는 것처럼 동작한다. 

### 재할당 금지 
- `const`로 선언한 변수는 원시 값을 할당한 경우 값을 변경할 수 없다. 
- 변수의 반대 개념인 **"상수"는 재할당이 금지된 변수**를 말한다.
- 원시 값은 변경할 수 없는 값이고, 변경하려면 재할당해야 하는데 `const`를 사용하면 재할당이 금지되므로 상수로 사용이 가능해지는 것이다.  
- 일반적으로 상수의 이름은 대문자로 선언해 상수임을 명확히 나타낸다.  
  - 여러 단어인 경우 언더스코어(`_`)로 구분하여 스네이크 케이스로 표현하는 것이 일반적 

### const와 객체  
- `const` 키워드로 선언된 변수에 원시 값을 할당한 경우 값을 바꿀 수 없지만 **객체를 할당한 경우 변경이 가능하다.**   
- **`const` 키워드는 재할당을 금지할 뿐 "불변"을 의미하는 것이 아니다!** 
  - 객체가 변경되더라도 변수에 할당된 참조 값은 변경되지 않는 것 


## 무엇을 사용하는게 좋을까?  
- 의외로 객체를 재할당하는 경우는 드물다고 한다. 일단 `const` 키워드를 사용하고 재할당이 필요한지 생각해본 뒤 `let`으로 바꿔도 결코 늦지 않다. 
- `let` 키워드를 사용할 때 변수의 스코프는 최대한 좁게 만든다. 

## reference 
- [모던 자바스크립트 Deep Dive](http://www.kyobobook.co.kr/product/detailViewKor.laf?ejkGb=KOR&mallGb=KOR&barcode=9791158392239&orderClick=LEa&Kc=)
- [생활코딩](https://opentutorials.org/course/743/6544)